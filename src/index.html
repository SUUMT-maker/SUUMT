<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SUUMT - 호흡 트레이너</title>
    <meta name="description" content="AI 기반 호흡 트레이너로 건강한 호흡을 만들어보세요">
    <meta name="theme-color" content="#667eea">
    
    <!-- PWA 설정 -->
    <link rel="manifest" href="../public/manifest.json">
    <link rel="apple-touch-icon" href="../public/assets/icon-192x192.png">
    
    <!-- CSS -->
    <link rel="stylesheet" href="css/style.css">
    
    <!-- Supabase -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- 로딩 화면 -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-logo">SUUMT</div>
            <div class="loading-spinner"></div>
        </div>
    </div>

    <!-- 로그인 화면 -->
    <div id="loginScreen" class="screen hidden">
        <div class="login-container">
            <div class="login-logo">
                <h1>SUUMT</h1>
                <p>AI 기반 호흡 트레이너</p>
            </div>
            <button id="loginKakaoBtn" class="kakao-login-btn">
                <span class="kakao-icon">카카오</span>
                카카오로 시작하기
            </button>
        </div>
    </div>

    <!-- 메인 앱 화면 -->
    <div id="appScreen" class="screen hidden">
        <!-- 상단 탭바 -->
        <nav class="tab-bar">
            <button class="tab-btn active" data-tab="home">
                <span class="tab-icon">🏠</span>
                <span class="tab-label">홈</span>
            </button>
            <button class="tab-btn" data-tab="records">
                <span class="tab-icon">📊</span>
                <span class="tab-label">기록</span>
            </button>
            <button class="tab-btn" data-tab="settings">
                <span class="tab-icon">⚙️</span>
                <span class="tab-label">설정</span>
            </button>
        </nav>

        <!-- 홈 탭 -->
        <div id="homeTab" class="tab-content active">
            <div class="home-tab-container">
                <!-- 슬로건 -->
                <div class="home-slogan">
                    <p>숨이트여야 삶이트인다 🌬️</p>
                </div>
                
                <!-- HomeTab 컴포넌트 -->
                <div id="homeTabContent" class="home-tab-content">
                    <!-- GreetingCard 컴포넌트 -->
                    <div class="greeting-card card mb-4">
                        <div class="greeting-content">
                            <div class="greeting-header">
                                <h2 id="greetingTitle">안녕하세요! 👋</h2>
                            </div>
                            <div class="greeting-message">
                                <p id="greetingMessage">오늘도 건강한 호흡을 만들어보세요</p>
                            </div>
                            <div class="greeting-goal">
                                <p id="greetingGoal">목표: 2회 중 0회 완료</p>
                            </div>
                        </div>
                    </div>

                    <!-- GoalProgressCard 컴포넌트 -->
                    <div class="goal-progress-card card mb-4">
                        <div class="goal-progress-content">
                            <div class="goal-progress-header">
                                <h3>오늘의 목표</h3>
                            </div>
                            <div class="goal-progress-bar">
                                <div class="progress-blocks">
                                    <!-- JS로 동적 생성 -->
                                </div>
                            </div>
                            <div class="goal-progress-text">
                                <p id="goalProgressText">2회 중 0회 완료했어요</p>
                            </div>
                            <div class="goal-progress-feedback">
                                <p id="goalProgressFeedback">첫 번째 운동을 시작해보세요! 🚀</p>
                            </div>
                        </div>
                    </div>

                    <!-- TodaySummaryCard 컴포넌트 (조건부 렌더링) -->
                    <div id="todaySummaryCard" class="today-summary-card card mb-4" style="display: none;">
                        <div class="today-summary-content">
                            <div class="today-summary-header">
                                <h3>오늘의 운동 요약</h3>
                            </div>
                            <div class="today-summary-body">
                                <div class="summary-item">
                                    <span class="summary-icon">⏱️</span>
                                    <span class="summary-label">운동 시간</span>
                                    <span class="summary-value" id="todayExerciseTime">-</span>
                                </div>
                                <div class="summary-item">
                                    <span class="summary-icon">🔄</span>
                                    <span class="summary-label">세트 수</span>
                                    <span class="summary-value" id="todaySets">-</span>
                                </div>
                                <div class="summary-item">
                                    <span class="summary-icon">🫁</span>
                                    <span class="summary-label">호흡 수</span>
                                    <span class="summary-value" id="todayBreaths">-</span>
                                </div>
                                <div class="summary-item">
                                    <span class="summary-icon">💪</span>
                                    <span class="summary-label">평균 저항</span>
                                    <span class="summary-value" id="todayResistance">-</span>
                                </div>
                                <div class="summary-item">
                                    <span class="summary-icon">😊</span>
                                    <span class="summary-label">내 느낌</span>
                                    <span class="summary-value" id="todayFeedback">-</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- DailySessionSlider 컴포넌트 (조건부 렌더링) -->
                    <div id="dailySessionSlider" class="daily-session-slider card mb-4" style="display: none;">
                        <div class="daily-session-header">
                            <h3>오늘의 운동 세션</h3>
                        </div>
                        <div class="session-slider-container">
                            <div class="session-slider-wrapper">
                                <div id="sessionSlider" class="session-slider">
                                    <!-- JS로 동적 생성 -->
                                </div>
                            </div>
                            <div class="slider-indicators">
                                <!-- JS로 동적 생성 -->
                            </div>
                        </div>
                    </div>

                    <!-- NoSessionCard 컴포넌트 (조건부 렌더링) -->
                    <div id="noSessionCard" class="no-session-card card mb-4" style="display: none;">
                        <div class="no-session-content">
                            <div class="no-session-icon">🫁</div>
                            <div class="no-session-header">
                                <h3>오늘은 아직 호흡 운동을 안 하셨어요</h3>
                            </div>
                            <div class="no-session-message">
                                <p>📈 꾸준함이 건강한 폐를 만듭니다!</p>
                            </div>
                            <div class="no-session-action">
                                <button id="startTrainingBtn" class="primary-btn">
                                    지금 바로 시작하기
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- AISummaryCard 컴포넌트 -->
                    <div id="aiSummaryCard" class="ai-summary-card card mb-4">
                        <div class="ai-summary-content">
                            <div class="ai-summary-header">
                                <div class="ai-summary-icon" id="aiSummaryIcon">🤖</div>
                                <h3>AI 숨트레이너의 한마디</h3>
                            </div>
                            <div class="ai-summary-message">
                                <p id="aiSummaryMessage">아직 AI 숨트레이너의 조언이 없어요. 오늘도 숨을 쉬며 시작해볼까요?</p>
                            </div>
                            <div class="ai-summary-date">
                                <p id="aiSummaryDate">분석 날짜: -</p>
                            </div>
                        </div>
                    </div>

                    <!-- WeeklyTrendCard 컴포넌트 -->
                    <div id="weeklyTrendCard" class="weekly-trend-card card mb-4">
                        <div class="weekly-trend-content">
                            <div class="weekly-trend-header">
                                <h3>이번 주 숨트 레포트</h3>
                                <p id="weeklyDateRange" class="weekly-date-range">날짜 범위 로딩 중...</p>
                            </div>
                            
                            <!-- 세션이 1개 이하일 경우 표시할 메시지 -->
                            <div id="weeklyInsufficientData" class="weekly-insufficient-data" style="display: none;">
                                <div class="insufficient-icon">📊</div>
                                <p>이번 주 기록이 아직 부족해요. 매일 꾸준히 한 번씩 도전해보세요!</p>
                            </div>
                            
                            <!-- 충분한 데이터가 있을 경우 표시할 내용 -->
                            <div id="weeklyTrendData" class="weekly-trend-data" style="display: none;">
                                <!-- 미니 막대 그래프 -->
                                <div class="weekly-chart-container">
                                    <canvas id="weeklyChart" class="weekly-chart"></canvas>
                                </div>
                                
                                <!-- 요약 통계 -->
                                <div class="weekly-stats">
                                    <div class="weekly-stat-item">
                                        <span class="weekly-stat-label">총 세션 수</span>
                                        <span class="weekly-stat-value" id="weeklyTotalSessions">-</span>
                                    </div>
                                    <div class="weekly-stat-item">
                                        <span class="weekly-stat-label">총 호흡 수</span>
                                        <span class="weekly-stat-value" id="weeklyTotalBreaths">-</span>
                                    </div>
                                    <div class="weekly-stat-item">
                                        <span class="weekly-stat-label">평균 저항 강도</span>
                                        <span class="weekly-stat-value" id="weeklyAvgResistance">-</span>
                                    </div>
                                </div>
                                
                                <!-- AI 코멘트 -->
                                <div class="weekly-ai-comment">
                                    <p id="weeklyAIComment">AI 코멘트 로딩 중...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 기록 탭 -->
        <div id="recordsTab" class="tab-content">
            <div class="records-container">
                <h2>운동 기록</h2>
                
                <!-- 상단 요약 카드 -->
                <div class="record-summary-overview card">
                    <h3>이번 주의 당신</h3>
                    <ul>
                        <li>운동한 날: <span id="weeklyActiveDays">-</span> / 7일</li>
                        <li>총 운동 시간: <span id="weeklyTotalTime">-</span></li>
                        <li>평균 자각 강도: <span id="weeklyAvgEffort">-</span></li>
                    </ul>
                </div>

                <!-- 달력 섹션 -->
                <div class="calendar-section">
                    <h3>운동 달력</h3>
                    <div class="records-calendar">
                        <!-- 달력은 JS로 동적 생성 -->
                    </div>
                </div>

                <!-- 세션 카드 컨테이너 -->
                <div class="sessions-section">
                    <h3>세션 기록</h3>
                    <div id="sessionCardsContainer" class="session-cards-container">
                        <!-- JS로 세션 카드 동적 생성 -->
                    </div>
                </div>
            </div>
        </div>

        <!-- 설정 탭 -->
        <div id="settingsTab" class="tab-content">
            <div class="settings-container">
                <h2>설정</h2>
                <div class="settings-content">
                    <button id="logoutBtn" class="secondary-btn">로그아웃</button>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="js/supabase.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/components/HomeTab.js"></script>
    <script src="js/components/SuumTrainingSetup.js"></script>
    <script src="js/components/SuumTrainingStartScreen.js"></script>
    <script src="js/components/SuumCountdownOverlay.js"></script>
    <script src="js/components/SuumTrainingSession.js"></script>
    <script src="js/home.js"></script>
    <script src="js/records.js"></script>
    <script src="js/app.js"></script>

    <!-- Service Worker 등록 -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('../public/service-worker.js')
                    .then(registration => {
                        console.log('SW registered: ', registration);
                    })
                    .catch(registrationError => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>
</body>
</html>
